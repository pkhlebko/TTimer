var trialTimer={};function getTime(){return(new Date).getTime()/1e3}trialTimer.TTimer=function(i){i.timeLimit;var t,o,e,n,s,d=i.timeLimit,c=0,a=0;function m(e){var t=getTime()-o-c,n=t+i.timeLimit-d;e=e||"finish",s=function(){},i.onTimeUpdate(Math.round(t),d),i.onFinish(t,n,e)}function l(e){t=e+i.sectionLimit,++a>i.sections?m("auto"):i.onNextSection(a)}function u(){var e=getTime()-o-c;t<=e&&l(e),i.onTimeUpdate(e,d-e,t-e),e<d?n=setTimeout(function(){s()},500):m("limit")}return this.strt=function(){o=getTime(),s=u,i.onStart(),l(0),s()},this.nextSection=function(){l(getTime()-o)},this.add30=function(){d-=30,t-=30,i.onPenalty(30)},this.add120=function(){d-=120,i.onPenalty(120)},this.pause=function(){e?(c+=getTime()-e,e=null,(s=u)(),i.onPauseResume()):(clearTimeout(n),s=function(){},e=getTime(),i.onPauseResume(!0))},this.finish=m,this},trialTimer.onLoad=function(){var n,e="sounds/start.mp3",o="sounds/finish.mp3",s="sounds/limit.mp3",t="sounds/section.mp3",d=document.getElementById("btnStartFinish"),i=document.getElementById("btnPause"),c=document.getElementById("btnNextSector"),a=document.getElementById("btnAdd30"),m=document.getElementById("btnAdd120"),l=document.getElementById("btnSettings"),u=document.getElementById("log"),r=document.getElementById("lblSectionTime"),f=document.getElementById("lblSpentTime"),T=document.getElementById("lblTimeLimit"),g=document.getElementById("lstTimeLimit"),v=document.getElementById("lstSectionLimit"),L=document.getElementById("lstSections"),y=document.getElementById("pnlSettings"),p=document.getElementById("pnlTime");function h(e,t){var n=new Date,i="<span>"+((n.getHours()<10?"0":"")+n.getHours())+":"+((n.getMinutes()<10?"0":"")+n.getMinutes())+":"+((n.getSeconds()<10?"0":"")+n.getSeconds())+"</span>",o=document.createElement("li");o.innerHTML='<li class="'+t+'"><span class="time">'+i+"</span> "+e+"</li>",u.insertBefore(o,u.children[1])}function E(e){new Audio(e).play()}function S(e,t){i.disabled=e,c.disabled=e,a.disabled=e,m.disabled=e,p.style.display=e?"none":"flex",t||(e?(i.removeEventListener("click",n.pause),c.removeEventListener("click",n.nextSection),a.removeEventListener("click",n.add30),m.removeEventListener("click",n.add120)):(i.addEventListener("click",n.pause),c.addEventListener("click",n.nextSection),a.addEventListener("click",n.add30),m.addEventListener("click",n.add120)))}function b(e,t,n){var i=t<0?0:t,o=n||0;r.innerHTML=Math.min(i,o).toFixed(1),f.innerHTML=e.toFixed(0),T.innerHTML=i.toFixed(0)}function I(){S(!1),function(){for(;u.firstChild;)u.removeChild(u.firstChild);u.innerHTML='<li class="hidden"></li>'}(),E(e),h("Start","start"),d.value="finish",d.innerHTML="Finish",y.style.display="none"}function k(e){h("Section #"+e),E(t)}function B(e,t,n){var i;switch(n){case"auto":i="Auto finish ",E(o);break;case"limit":i="Time limit exceeded ",E(s);break;default:i="Finish ",E(o)}h(i+e.toFixed(2)+"sec. With penalty "+t.toFixed(2)+"sec.",n),S(!0),d.value="start",d.innerHTML="Start"}function x(e){h("Penalty +"+e,"penalty")}function M(e){e?(i.innerHTML="Resume",h("Pause","pause")):(i.innerHTML="Pause",h("Resume","resume"))}S(!0,!0),d.addEventListener("click",function(){switch(d.value){case"start":var e={timeLimit:parseInt(g.value),sectionLimit:parseInt(v.value),sections:parseInt(L.value),onStart:I,onTimeUpdate:b,onNextSection:k,onPenalty:x,onFinish:B,onPauseResume:M};(n=new trialTimer.TTimer(e)).strt();break;case"finish":n.finish()}}),l.addEventListener("click",function(){y.style.display="block"==y.style.display?"none":"block"}),u.addEventListener("click",function(){document.execCommand("SelectAll"),document.execCommand("Copy"),window.getSelection?window.getSelection().removeAllRanges():document.selection&&document.selection.empty()})},document.addEventListener("DOMContentLoaded",trialTimer.onLoad,!1);
//# sourceMappingURL=main.js.map
